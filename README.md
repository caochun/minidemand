# MiniDemand

ä¸€ä¸ªè½»é‡çº§çš„ Open OnDemand å®ç°ï¼Œæä¾› Web ç»ˆç«¯ã€æ–‡ä»¶ç®¡ç†å’Œ HPC ä»»åŠ¡ç®¡ç†åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ–¥ï¸ Web ç»ˆç«¯ (Shell App)
- åŸºäº WebSocket çš„å®æ—¶ç»ˆç«¯äº¤äº’
- æ”¯æŒ hterm ç»ˆç«¯æ¨¡æ‹Ÿå™¨
- å¯é…ç½®çš„ä¸»é¢˜å’Œå…‰æ ‡æ ·å¼
- æ”¯æŒ ANSI è½¬ä¹‰åºåˆ—æ¸²æŸ“
- è‡ªåŠ¨é‡è¿å’Œä¼šè¯æ¢å¤

### ğŸ“ æ–‡ä»¶ç®¡ç† (Files App)
- æ–‡ä»¶æµè§ˆå™¨ç•Œé¢
- æ”¯æŒæ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ã€åˆ é™¤
- åœ¨çº¿æ–‡ä»¶ç¼–è¾‘å™¨
- ç›®å½•åˆ›å»ºå’Œå¯¼èˆª
- æ–‡ä»¶æƒé™ç®¡ç†

### ğŸ¯ HPC ä»»åŠ¡ç®¡ç† (Jobs App)
- ä»»åŠ¡æäº¤å’Œç›‘æ§
- ä»»åŠ¡æ¨¡æ¿ç®¡ç† (CRUD)
- æ”¯æŒå¤šç§ä½œä¸šç±»å‹ï¼š
  - åŸºç¡€ä½œä¸š (Basic Job)
  - GPU ä½œä¸š (GPU Job)
  - å¹¶è¡Œä½œä¸š (Parallel Job)
- å®æ—¶ä»»åŠ¡çŠ¶æ€æ›´æ–°
- ä»»åŠ¡å†å²è®°å½•

### ğŸ–¥ï¸ äº¤äº’å¼æ¡Œé¢ (Desktop App)
- é€šè¿‡æµè§ˆå™¨è®¿é—®è¿œç¨‹å›¾å½¢åŒ–æ¡Œé¢
- æ”¯æŒå¤šç§æ¡Œé¢ç¯å¢ƒï¼š
  - MATE Desktop
  - Xfce Desktop
  - GNOME Desktop
  - KDE Plasma
- ä¼šè¯ç®¡ç†ï¼ˆåˆ›å»ºã€ç›‘æ§ã€åœæ­¢ï¼‰
- èµ„æºé…ç½®ï¼ˆåˆ†è¾¨ç‡ã€CPUã€å†…å­˜ï¼‰
- VNC è¿æ¥æ”¯æŒ

### ğŸ  ç»Ÿä¸€ä»ªè¡¨æ¿ (Dashboard)
- åº”ç”¨ç»Ÿä¸€ç®¡ç†ç•Œé¢
- åŠ¨æ€åº”ç”¨å‘ç°
- åº”ç”¨çŠ¶æ€ç›‘æ§
- å¿«é€Ÿåº”ç”¨è®¿é—®

## é¡¹ç›®æ¶æ„

```
minidemand/
â”œâ”€â”€ apps/                    # åº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ shell/              # Web ç»ˆç«¯åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ server/         # Node.js æœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ public/         # å‰ç«¯èµ„æº
â”‚   â”‚   â””â”€â”€ manifest.yml    # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ files/              # æ–‡ä»¶ç®¡ç†åº”ç”¨
â”‚   â”œâ”€â”€ jobs/               # HPC ä»»åŠ¡ç®¡ç†åº”ç”¨
â”‚   â”œâ”€â”€ desktop/            # äº¤äº’å¼æ¡Œé¢åº”ç”¨
â”‚   â””â”€â”€ dashboard/          # ç»Ÿä¸€ä»ªè¡¨æ¿
â”œâ”€â”€ shared/                 # å…±äº«å·¥å…·
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â””â”€â”€ scripts/               # å¯åŠ¨è„šæœ¬
```

## æŠ€æœ¯æ ˆ

- **åç«¯**: Node.js + Express
- **å‰ç«¯**: HTML5 + CSS3 + JavaScript
- **ç»ˆç«¯**: hterm + node-pty
- **é€šä¿¡**: WebSocket
- **æ–‡ä»¶ç³»ç»Ÿ**: Node.js fs API

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16.0.0
- npm >= 8.0.0

### å®‰è£…ä¾èµ–

```bash
# å®‰è£…æ ¹ç›®å½•ä¾èµ–
npm install

# å®‰è£…å„åº”ç”¨ä¾èµ–
cd apps/shell && npm install
cd ../files && npm install
cd ../jobs && npm install
cd ../desktop && npm install
cd ../dashboard && npm install
```

### å¯åŠ¨æœåŠ¡

#### æ–¹å¼ä¸€ï¼šä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡
```bash
./scripts/start-all.sh
```

#### æ–¹å¼äºŒï¼šåˆ†åˆ«å¯åŠ¨å„åº”ç”¨
```bash
# å¯åŠ¨ Shell åº”ç”¨ (ç«¯å£ 3000)
cd apps/shell && npm start

# å¯åŠ¨ Files åº”ç”¨ (ç«¯å£ 3001)
cd apps/files && npm start

# å¯åŠ¨ Jobs åº”ç”¨ (ç«¯å£ 3003)
cd apps/jobs && npm start

# å¯åŠ¨ Desktop åº”ç”¨ (ç«¯å£ 3004)
cd apps/desktop && npm start

# å¯åŠ¨ Dashboard åº”ç”¨ (ç«¯å£ 3002)
cd apps/dashboard && npm start
```

### è®¿é—®åº”ç”¨

- **Dashboard**: http://localhost:3002
- **Shell**: http://localhost:3000
- **Files**: http://localhost:3001
- **Jobs**: http://localhost:3003
- **Desktop**: http://localhost:3004

## é…ç½®è¯´æ˜

### åº”ç”¨é…ç½®

æ¯ä¸ªåº”ç”¨éƒ½æœ‰ç‹¬ç«‹çš„ `manifest.yml` é…ç½®æ–‡ä»¶ï¼š

```yaml
---
name: åº”ç”¨åç§°
description: åº”ç”¨æè¿°
category: åº”ç”¨åˆ†ç±»
icon: fa://å›¾æ ‡åç§°
role: åº”ç”¨è§’è‰²
url: åº”ç”¨è·¯å¾„
new_window: æ˜¯å¦æ–°çª—å£æ‰“å¼€
id: åº”ç”¨å”¯ä¸€æ ‡è¯†
```

### ç«¯å£é…ç½®

é»˜è®¤ç«¯å£åˆ†é…ï¼š
- Shell: 3000
- Files: 3001
- Dashboard: 3002
- Jobs: 3003
- Desktop: 3004

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åº”ç”¨

1. åœ¨ `apps/` ç›®å½•ä¸‹åˆ›å»ºæ–°åº”ç”¨ç›®å½•
2. åˆ›å»º `manifest.yml` é…ç½®æ–‡ä»¶
3. å®ç° `server/app.js` æœåŠ¡å™¨
4. åˆ›å»º `public/` å‰ç«¯èµ„æº
5. åœ¨ Dashboard ä¸­æ³¨å†Œæ–°åº”ç”¨

### åº”ç”¨ç»“æ„

```
apps/your-app/
â”œâ”€â”€ manifest.yml          # åº”ç”¨é…ç½®
â”œâ”€â”€ package.json          # ä¾èµ–é…ç½®
â”œâ”€â”€ server/
â”‚   â””â”€â”€ app.js           # æœåŠ¡å™¨ä»£ç 
â””â”€â”€ public/
    â”œâ”€â”€ index.html       # ä¸»é¡µé¢
    â”œâ”€â”€ css/
    â”‚   â””â”€â”€ style.css    # æ ·å¼æ–‡ä»¶
    â””â”€â”€ js/
        â””â”€â”€ app.js       # å‰ç«¯é€»è¾‘
```

## API æ–‡æ¡£

### Shell åº”ç”¨ API

- `GET /` - ç»ˆç«¯é¡µé¢
- `WebSocket /ws` - ç»ˆç«¯è¿æ¥

### Files åº”ç”¨ API

- `GET /api/files?path=...` - è·å–æ–‡ä»¶åˆ—è¡¨
- `POST /api/files/upload` - ä¸Šä¼ æ–‡ä»¶
- `GET /api/files/download?path=...` - ä¸‹è½½æ–‡ä»¶
- `DELETE /api/files?path=...` - åˆ é™¤æ–‡ä»¶
- `POST /api/files/mkdir` - åˆ›å»ºç›®å½•

### Jobs åº”ç”¨ API

- `GET /api/jobs` - è·å–ä»»åŠ¡åˆ—è¡¨
- `POST /api/jobs` - æäº¤æ–°ä»»åŠ¡
- `GET /api/jobs/:id` - è·å–ä»»åŠ¡è¯¦æƒ…
- `DELETE /api/jobs/:id` - å–æ¶ˆä»»åŠ¡
- `GET /api/templates` - è·å–æ¨¡æ¿åˆ—è¡¨
- `POST /api/templates` - åˆ›å»ºæ¨¡æ¿
- `PUT /api/templates/:id` - æ›´æ–°æ¨¡æ¿
- `DELETE /api/templates/:id` - åˆ é™¤æ¨¡æ¿

### Dashboard åº”ç”¨ API

- `GET /api/apps` - è·å–åº”ç”¨åˆ—è¡¨

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£å†²çª**
   - æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š`lsof -i :3000`
   - ä¿®æ”¹åº”ç”¨é…ç½®ä¸­çš„ç«¯å£å·

2. **ä¾èµ–å®‰è£…å¤±è´¥**
   - ä½¿ç”¨å›½å†…é•œåƒï¼š`npm config set registry https://registry.npmmirror.com`
   - æ¸…é™¤ç¼“å­˜ï¼š`npm cache clean --force`

3. **WebSocket è¿æ¥å¤±è´¥**
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
   - ç¡®è®¤æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ

4. **æ–‡ä»¶æƒé™é—®é¢˜**
   - ç¡®ä¿åº”ç”¨æœ‰æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™
   - æ£€æŸ¥æ–‡ä»¶è·¯å¾„é…ç½®

### æ—¥å¿—æŸ¥çœ‹

å„åº”ç”¨ä¼šåœ¨æ§åˆ¶å°è¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼ŒåŒ…æ‹¬ï¼š
- æœåŠ¡å™¨å¯åŠ¨ä¿¡æ¯
- API è¯·æ±‚æ—¥å¿—
- WebSocket è¿æ¥çŠ¶æ€
- é”™è¯¯ä¿¡æ¯

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## è®¸å¯è¯

MIT License

## è‡´è°¢

- [Open OnDemand](https://openondemand.org/) - çµæ„Ÿæ¥æº
- [hterm](https://github.com/hterm/hterm) - ç»ˆç«¯æ¨¡æ‹Ÿå™¨
- [node-pty](https://github.com/microsoft/node-pty) - ä¼ªç»ˆç«¯æ”¯æŒ

## æ›´æ–°æ—¥å¿—

### v2.1.0 (2025-01-29)
- ğŸ‰ æ·»åŠ äº¤äº’å¼æ¡Œé¢åº”ç”¨ï¼ˆDesktop Appï¼‰
- âœ¨ æ”¯æŒ MATEã€Xfceã€GNOMEã€KDE å››ç§æ¡Œé¢ç¯å¢ƒ
- âœ¨ å®Œæ•´çš„æ¡Œé¢ä¼šè¯ç®¡ç†åŠŸèƒ½
- âœ¨ èµ„æºé…ç½®å’Œ VNC è¿æ¥æ”¯æŒ
- ğŸ“ å®Œå–„çš„æ–‡æ¡£å’Œå¯åŠ¨è„šæœ¬
- ğŸ¨ ç°ä»£åŒ–å“åº”å¼ UI è®¾è®¡

### v2.0.0 (2025-01-28)
- ğŸ‰ é‡æ„ä¸ºæ¨¡å—åŒ–æ¶æ„
- âœ¨ æ·»åŠ æ–‡ä»¶ç®¡ç†åŠŸèƒ½
- âœ¨ æ·»åŠ  HPC ä»»åŠ¡ç®¡ç†åŠŸèƒ½
- âœ¨ æ·»åŠ ç»Ÿä¸€ä»ªè¡¨æ¿
- ğŸ”§ ä¼˜åŒ–åº”ç”¨é…ç½®å’Œéƒ¨ç½²
- ğŸ› ä¿®å¤ç»ˆç«¯æ˜¾ç¤ºå’Œè¿æ¥é—®é¢˜

### v1.0.0 (2025-01-27)
- ğŸ‰ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ¨ åŸºç¡€ Web ç»ˆç«¯åŠŸèƒ½
- ğŸ”§ åŸºç¡€é¡¹ç›®ç»“æ„